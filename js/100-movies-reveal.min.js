let sfxMuted=!1;const panelSmarts=function(t,e){const o=t.parentElement;let n=new Image;n.addEventListener("load",(function(){t.width=n.width,t.height=n.height;const i=t.width*t.height;let s=0;const a=t.getContext("2d");a.drawImage(n,0,0,t.width,t.height),a.save();const c="Waiting for something amazing to happen...",d="Well done, you claim to have watched 100% of the entirety of this movie!",l=o.parentElement.querySelector(".controls"),u=l.querySelector(".icon-cancel-circle");u.setAttribute("title","Restore the scratchable layer!");const r=l.querySelector(".icon-forward2");r.setAttribute("title","Scratch this movie off the lazy way!");const h=o.getAttribute("data-no");let m=parseInt(o.getAttribute("data-watched")),f=null;m?(f=l.querySelector(".icon-checkmark2"),f.setAttribute("title",d)):(f=l.querySelector(".icon-neutral"),f.setAttribute("title",c));function g(){sfxMuted||soundbox.play("scratching",null,null,!0),f.classList.remove("icon-neutral"),f.classList.add("icon-baffled"),f.setAttribute("title","What do you think you're doing?!"),u.classList.remove("hide"),S()}function p(){clearTimeout(s),a.closePath(),w()?L():window.soundbox.stop_all()}function b(e,o){const n=t.getBoundingClientRect();return{x:Math.floor((e-n.left)/(n.right-n.left)*t.width),y:Math.floor((o-n.top)/(n.bottom-n.top)*t.height)}}function v(t,e){a.globalCompositeOperation="destination-out",a.lineJoin="round",a.lineCap="round",a.fillStyle="#000",a.beginPath(),a.arc(t-5,e+10,15,0,2*Math.PI),a.closePath(),a.fill(),a.beginPath(),a.moveTo(t-5,e+10)}function y(n){ajaxPost(encodeURI("action="+n+"&listID="+e+"&movieNo="+h),(function(e){"added"===e?(o.setAttribute("data-watched","1"),m=1):"removed"===e&&(o.setAttribute("data-watched","0"),m=0);const n=t.closest(".grid-container.full").querySelector(".watched");let i=parseInt(n.textContent);n.textContent=String(m?i+1:i-1)}))}function x(){const e=a.getImageData(0,0,t.width,t.height);let o=0;for(let t=0,n=e.data.length;t<n;t+=4)0===e.data[t]&&0===e.data[t+1]&&0===e.data[t+2]&&0===e.data[t+3]&&o++;return o/i*100}function w(){return x()>90||((x()>35||o.classList.contains("multi-img"))&&r.classList.remove("hide"),!1)}function L(){window.soundbox.stop_all(),a.clearRect(0,0,t.width,t.height),t.classList.add("hide"),sfxMuted||soundbox.play("pickup7a"),r.classList.add("hide"),f.classList.remove("icon-baffled"),f.classList.add("icon-checkmark2"),f.setAttribute("title",d),m||y("add")}function S(){s=setTimeout((function(){w()?(clearTimeout(s),L()):S()}),1500)}u.addEventListener("click",(function(){a.restore(),a.drawImage(n,0,0,t.width,t.height),a.save(),sfxMuted||soundbox.play("pickup7b"),u.classList.add("hide"),r.classList.add("hide"),f.classList.remove("icon-checkmark2","icon-baffled"),f.classList.add("icon-neutral"),f.setAttribute("title",c),t.classList.remove("hide"),m&&y("remove")})),r.addEventListener("click",(function(){L(),r.classList.add("hide")})),t.addEventListener("mousedown",g),t.addEventListener("mouseup",p),t.addEventListener("mousemove",(function(t){const e=b(t.clientX,t.clientY);var o;("buttons"in(o=t)?1===o.buttons:"which"in o?1===o.which:1===o.button)&&v(e.x,e.y)}),!1),t.addEventListener("touchstart",g),t.addEventListener("touchend",p),t.addEventListener("touchmove",(function(t){t.preventDefault();const e=t.targetTouches[0];if(e){const t=b(e.pageX,e.pageY);v(t.x,t.y)}}),!1)})),n.crossOrigin="Anonymous",n.src=o.querySelector("img").src},ajaxPost=function(t,e){const o=new XMLHttpRequest;o.open("POST","./"),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.onload=function(){200===o.status&&"failed"===o.responseText?alert("Something went wrong.  Response was: "+o.responseText):200!==o.status?alert("Request failed.  Returned status of: "+o.status):void 0!==e&&e(o.responseText)},o.send(t)},playBtnSfx=function(){if(!sfxMuted){const t=["comp11","comp12"],e=Math.floor(Math.random()*t.length);soundbox.play(t[e])}},switchTab=function(t,e){playBtnSfx();let o,n=document.getElementsByClassName("tabcontent");for(o=0;o<n.length;o++)n[o].style.display="none";for(document.getElementById(e).style.display="block",n=document.getElementsByClassName("tabmenu"),o=0;o<n.length;o++)n[o].removeAttribute("aria-selected");const i=document.getElementById(t);i.setAttribute("aria-selected","true"),ajaxPost(encodeURI("activeListID="+i.dataset.list_id))};!function(){const t=document.querySelectorAll(".cards-100-top");t.forEach((function(t){const e=t.nextElementSibling,o=t.querySelector(".waiting"),n=t.querySelector(".userCode > input"),i=t.querySelector(".button");n.addEventListener("keyup",(function(t){if("Enter"===t.key){o.classList.remove("hide"),i.classList.add("hide");const t=n.getAttribute("data-code");ajaxPost(encodeURI("codeInput="+n.value+"&listID="+e.dataset.id),(function(e){e!==t.toUpperCase()?document.location.reload(!0):(i.classList.remove("hide"),o.classList.add("hide"),n.value=t)}))}})),i.addEventListener("click",(function(){playBtnSfx(),o.classList.remove("hide"),i.classList.add("hide"),ajaxPost(encodeURI("codeRequest=1&listID="+e.dataset.id),(function(){document.location.reload(!0)}))}));e.querySelectorAll("canvas").forEach((function(t){panelSmarts(t,e.dataset.id)}))}));document.querySelectorAll(".tabmenu").forEach((function(t){t.addEventListener("click",(function(){switchTab(this.getAttribute("id"),this.getAttribute("data-id")),document.getElementById("foot-criteria").textContent=this.getAttribute("data-foot_criteria");const t="books"===this.getAttribute("data-list_type")?"google-books":"themoviedb";document.getElementById("foot-logo").setAttribute("class",t+"-logo")}))}));const e=document.getElementById("mute-btn");e.classList.contains("icon-volume-mute2")&&(sfxMuted=!0),e.addEventListener("click",(function(){e.classList.contains("icon-volume-high")?(window.soundbox.stop_all(),sfxMuted=1,e.classList.remove("icon-volume-high"),e.classList.add("icon-volume-mute2"),e.title="Unmute"):(sfxMuted=0,playBtnSfx(),e.classList.remove("icon-volume-mute2"),e.classList.add("icon-volume-high"),e.title="Mute"),ajaxPost(encodeURI("muteSfx="+sfxMuted))})),window.addEventListener("load",(function(){const e="/100-movies/assets/sound/";window.soundbox=new SoundBox,soundbox.load("scratching",e+"Scratching-Paper.mp3").then((function(t){})),soundbox.load("pickup7a",e+"Pickup_Coin7a.mp3").then((function(t){})),soundbox.load("pickup7b",e+"Pickup_Coin7b.mp3").then((function(t){})),soundbox.load("comp11",e+"STcomp011.wav").then((function(t){})),soundbox.load("comp12",e+"STcomp012.wav").then((function(t){})),t.forEach((function(t){t.nextElementSibling.classList.remove("hide");t.querySelector(".waiting").classList.add("hide")}))}))}();