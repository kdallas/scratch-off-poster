let sfxMuted=!1;const panelSmarts=function(t,e){const n=t.parentElement;let o=new Image;o.addEventListener("load",(function(){t.width=o.width,t.height=o.height;const i=t.width*t.height;let s=0;const a=t.getContext("2d");a.drawImage(o,0,0,t.width,t.height),a.save();const c="Waiting for something amazing to happen...",d="Well done, you claim to have watched 100% of the entirety of this movie!",l=n.parentElement.querySelector(".controls"),u=l.querySelector(".icon-cancel-circle");u.setAttribute("title","Restore the scratchable layer!");const r=l.querySelector(".icon-forward2");r.setAttribute("title","Scratch this movie off the lazy way!");const h=n.getAttribute("data-no");let m=parseInt(n.getAttribute("data-watched")),f=null;m?(f=l.querySelector(".icon-checkmark2"),f.setAttribute("title",d)):(f=l.querySelector(".icon-neutral"),f.setAttribute("title",c));function g(){sfxMuted||soundbox.play("scratching",null,null,!0),f.classList.remove("icon-neutral"),f.classList.add("icon-baffled"),f.setAttribute("title","What do you think you're doing?!"),u.classList.remove("hide"),S()}function p(){clearTimeout(s),a.closePath(),y()?x():window.soundbox.stop_all()}function v(e,n){const o=t.getBoundingClientRect();return{x:Math.floor((e-o.left)/(o.right-o.left)*t.width),y:Math.floor((n-o.top)/(o.bottom-o.top)*t.height)}}function b(e,n){a.globalCompositeOperation="destination-out",a.lineJoin="round",a.lineCap="round",a.fillStyle="#000";const o=a.canvas.clientWidth,i=a.canvas.clientHeight,s=t.width/o*4,c=t.height/i*8;a.beginPath(),a.arc(e,n,s+c,0,2*Math.PI),a.closePath(),a.fill(),a.beginPath(),a.moveTo(e,n)}function w(o){ajaxPost(encodeURI("action="+o+"&listID="+e+"&movieNo="+h),(function(e){"added"===e?(n.setAttribute("data-watched","1"),m=1):"removed"===e&&(n.setAttribute("data-watched","0"),m=0);const o=t.closest(".grid-container.full").querySelector(".watched");let i=parseInt(o.textContent);o.textContent=String(m?i+1:i-1)}))}function L(){const e=a.getImageData(0,0,t.width,t.height);let n=0;for(let t=0,o=e.data.length;t<o;t+=4)0===e.data[t]&&0===e.data[t+1]&&0===e.data[t+2]&&0===e.data[t+3]&&n++;return n/i*100}function y(){return L()>90||((L()>35||n.classList.contains("multi-img"))&&r.classList.remove("hide"),!1)}function x(){window.soundbox.stop_all(),a.clearRect(0,0,t.width,t.height),t.classList.add("hide"),sfxMuted||soundbox.play("pickup7a"),r.classList.add("hide"),f.classList.remove("icon-baffled"),f.classList.add("icon-checkmark2"),f.setAttribute("title",d),m||w("add")}function S(){s=setTimeout((function(){y()?(clearTimeout(s),x()):S()}),1500)}u.addEventListener("click",(function(){a.restore(),a.drawImage(o,0,0,t.width,t.height),a.save(),sfxMuted||soundbox.play("pickup7b"),u.classList.add("hide"),r.classList.add("hide"),f.classList.remove("icon-checkmark2","icon-baffled"),f.classList.add("icon-neutral"),f.setAttribute("title",c),t.classList.remove("hide"),m&&w("remove")})),r.addEventListener("click",(function(){x(),r.classList.add("hide")})),t.addEventListener("mousedown",g),t.addEventListener("mouseup",p),t.addEventListener("mousemove",(function(t){const e=v(t.clientX,t.clientY);var n;("buttons"in(n=t)?1===n.buttons:"which"in n?1===n.which:1===n.button)&&b(e.x,e.y)}),!1),t.addEventListener("touchstart",g),t.addEventListener("touchend",p),t.addEventListener("touchmove",(function(t){t.preventDefault();const e=t.targetTouches[0];if(e){const t=v(e.clientX,e.clientY);b(t.x,t.y)}}),!1)})),o.crossOrigin="Anonymous",o.src=n.querySelector("img").src},ajaxPost=function(t,e){const n=new XMLHttpRequest;n.open("POST","./"),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.onload=function(){200===n.status&&"failed"===n.responseText?alert("Something went wrong.  Response was: "+n.responseText):200!==n.status?alert("Request failed.  Returned status of: "+n.status):void 0!==e&&e(n.responseText)},n.send(t)},playBtnSfx=function(){if(!sfxMuted){const t=["comp11","comp12"],e=Math.floor(Math.random()*t.length);soundbox.play(t[e])}},switchTab=function(t){const e=document.getElementsByClassName("tabmenu");for(let n=0;n<e.length;n++)e[n].removeAttribute("aria-selected"),e[n].getAttribute("data-list_id")===t&&e[n].setAttribute("aria-selected","true")},loadRouting=function(t,e){const n=document.createElement("script");n.src=t,document.body.appendChild(n),n.onreadystatechange=e,n.onload=e},initRouting=function(){const t=document.querySelectorAll(".tabmenu");let e=[];for(let n=1;n<t.length+1;n++)e.push(new Route(String(n),"?lid="+String(n),1===n));new Router(e)},addGridEvents=function(){document.querySelectorAll(".cards-100-top").forEach((function(t){const e=t.nextElementSibling,n=t.querySelector(".waiting"),o=t.querySelector(".userCode > input"),i=t.querySelector(".button");o.addEventListener("keyup",(function(t){if("Enter"===t.key){n.classList.remove("hide"),i.classList.add("hide");const t=o.getAttribute("data-code");ajaxPost(encodeURI("codeInput="+o.value+"&listID="+e.dataset.id),(function(e){e!==t.toUpperCase()?document.location.reload(!0):(i.classList.remove("hide"),n.classList.add("hide"),o.value=t)}))}})),i.addEventListener("click",(function(){playBtnSfx(),n.classList.remove("hide"),i.classList.add("hide"),ajaxPost(encodeURI("codeRequest=1&listID="+e.dataset.id),(function(){document.location.reload(!0)}))}));e.querySelectorAll("canvas").forEach((function(t){panelSmarts(t,e.dataset.id)})),switchTab(e.dataset.id),setTimeout((function(){e.classList.remove("hide"),n.classList.add("hide")}),500)}))},isOverflown=function(t){return t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth};!function(){document.querySelectorAll(".tabmenu").forEach((function(t){t.addEventListener("click",(function(){playBtnSfx(),switchTab(this.getAttribute("data-list_id")),document.getElementById("foot-criteria").textContent=this.getAttribute("data-foot_criteria");const t="books"===this.getAttribute("data-list_type")?"google-books":"themoviedb";document.getElementById("foot-logo").setAttribute("class",t+"-logo")}))}));const t=document.getElementById("mute-btn");t.classList.contains("icon-volume-mute2")&&(sfxMuted=!0),t.addEventListener("click",(function(){t.classList.contains("icon-volume-high")?(window.soundbox.stop_all(),sfxMuted=1,t.classList.remove("icon-volume-high"),t.classList.add("icon-volume-mute2"),t.title="Unmute"):(sfxMuted=0,playBtnSfx(),t.classList.remove("icon-volume-mute2"),t.classList.add("icon-volume-high"),t.title="Mute"),ajaxPost(encodeURI("muteSfx="+sfxMuted))})),window.addEventListener("load",(function(){const t="/100-movies/assets/sound/";window.soundbox=new SoundBox,soundbox.load("scratching",t+"Scratching-Paper.mp3").then((function(t){})),soundbox.load("pickup7a",t+"Pickup_Coin7a.mp3").then((function(t){})),soundbox.load("pickup7b",t+"Pickup_Coin7b.mp3").then((function(t){})),soundbox.load("comp11",t+"STcomp011.wav").then((function(t){})),soundbox.load("comp12",t+"STcomp012.wav").then((function(t){}))}));const e=document.querySelector(".tabs");isOverflown(e)&&e.classList.add("show-menu-btn"),window.addEventListener("resize",(function(){isOverflown(e)?e.classList.add("show-menu-btn"):(e.classList.remove("show-menu-btn"),e.classList.remove("show-menu-items"))}));document.querySelector(".icon-menu").addEventListener("click",(function(){e.classList.contains("show-menu-items")?e.classList.remove("show-menu-items"):e.classList.add("show-menu-items")})),loadRouting("./js/routing.min.js",initRouting)}();